/*
 * osadaMain.c
 *
 *  Created on: 5/9/2016
 *      Author: utnso
 */
#include <stdint.h>
#include "osada.h"
#include <stdlib.h>
#include <stdio.h>
/*
 Antes hay que hacer esto
 truncate --size 100M disco.bin
 ./osada-format disco.bin
*/


int main(void) {
	char *ruta = "/home/utnso/tp-2016-2c-CompuMundoHiperMegaRed/cmhmr-osada/disco.bin";
	osada_file *osadaFile = leerArchivoParaOsadaFile(ruta);
	printf("Tamanio: %i\n", devolverTamanio(osadaFile));
	printf("Nombre: %d\n", (unsigned char)devolverNombreDelArchivo(osadaFile));
	printf("Directorio Padre: %i\n", devolverDirectorioPadre(osadaFile));
	printf("Ultima Mod: %d\n", devolverUltimaMod(osadaFile));
	printf("Primer Bloque: %i\n", devolverPrimerBloque(osadaFile));

	osada_header *osadaHeader = leerArchivoParaHeader(ruta);
	unsigned char magic_number[7]; // OSADAFS
	uint8_t version;
	printf("magic_number: %i\n", devolverMagicNumbre(osadaHeader));
	printf("version: %i\n", devolverVersion(osadaHeader));
	printf("fs_blocks: %i\n", devolverFSBloques(osadaHeader));
	unsigned char magic_number[7]; // OSADAFS
	uint8_t version;
	uint32_t fs_blocks; // total amount of blocks
	uint32_t bitmap_blocks; // bitmap size in blocks
	uint32_t allocations_table_offset; // allocations table's first block number
	uint32_t data_blocks; // amount of data blocks
	unsigned char padding[40]; // useless bytes just to complete the block size

	ruta = "";
	free(osadaFile);

	return 0;

}
